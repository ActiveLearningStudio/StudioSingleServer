!function(){"use strict";H5PEditor.widgets.multiLineSelect=H5PEditor.MultiLineSelect=function(e,t,i,n){var s=this;this.parent=e,this.field=t,this.params=i,this.setValue=n,this.value=this.params,this.id=H5PEditor.getNextFieldId(this.field),this.changes=[],this.appendTo=function(e){var t=H5PEditor.createFieldMarkup(s.field,"",s.id),i=s.createSelect();e[0].innerHTML=t;var n=e[0].querySelector(".h5p-errors");n.parentNode.insertBefore(i,n),s.select=i},this.toggleListBox=function(e){var t=s.listBox.classList.contains("hidden");if(!(e=void 0!==e?e:t))return s.listBox.classList.add("hidden"),void s.selectButton.removeAttribute("aria-expanded");s.listBox.classList.remove("hidden"),s.selectButton.setAttribute("aria-expanded","true"),s.listBox.focus()},this.moveVertically=function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=s.listBox.querySelector(".focused"),i=t.previousSibling;e&&(i=t.nextSibling),i&&(s.toggleListBox(!0),s.chooseOption(i))},this.chooseOption=function(e){var t=s.listBox.querySelector(".focused");t&&(t.classList.remove("focused"),t.removeAttribute("aria-selected")),e.classList.add("focused"),e.setAttribute("aria-selected","true"),s.selectButton.innerHTML=e.innerHTML,s.listBox.setAttribute("aria-activedescendant",e.id);var i=e.id.split("-");s.value=i[i.length-1],s.setValue(s.field,s.value),s.triggerListeners(s.value)},this.createSelect=function(){var e=document.createElement("div");e.classList.add("h5p-editor-multi-line-select");var t=document.createElement("button");t.setAttribute("aria-haspopup","listbox"),t.classList.add("multi-select"),s.selectButton=t,t.addEventListener("click",(function(){s.toggleListBox()})),t.addEventListener("keydown",(function(e){switch(e.key){case"Down":case"ArrowDown":s.moveVertically(),e.preventDefault();break;case"Up":case"ArrowUp":s.moveVertically(!1),e.preventDefault()}}));var i,n=document.createElement("ul");return n.tabIndex=-1,n.setAttribute("role","listbox"),n.classList.add("hidden"),n.classList.add("listbox"),n.addEventListener("keydown",(function(e){switch(e.key){case"Down":case"ArrowDown":s.moveVertically(),e.preventDefault();break;case"Up":case"ArrowUp":s.moveVertically(!1),e.preventDefault();break;case"Enter":case" ":s.selectButton.focus(),e.preventDefault()}})),n.addEventListener("blur",(function(e){var t=null===e.relatedTarget&&(n.contains(document.activeElement)||n===document.activeElement);e.relatedTarget&&(n.contains(e.relatedTarget)||n===e.relatedTarget)||t||s.toggleListBox(!1)})),s.listBox=n,s.field.options.forEach((function(e){var t=document.createElement("li");t.setAttribute("role","option"),t.id=s.id+"-"+e.value;var a=document.createElement("div");a.classList.add("title"),a.innerHTML=e.label;var r=document.createElement("div");r.classList.add("description"),r.innerHTML=e.description,t.appendChild(a),t.appendChild(r),t.addEventListener("keydown",(function(e){switch(e.key){case"Down":case"ArrowDown":s.moveVertically(!1),e.preventDefault();break;case"Up":case"ArrowUp":s.moveVertically(),e.preventDefault()}})),t.addEventListener("click",(function(){s.chooseOption(t),s.toggleListBox(!1)})),n.appendChild(t),s.params!==e.value&&i||(i=t)})),s.chooseOption(i),e.appendChild(t),e.appendChild(n),e},this.triggerListeners=function(e){s.changes.forEach((function(t){t(e)}))},this.validate=function(){return!0},this.getElement=function(){return s.select}}}();